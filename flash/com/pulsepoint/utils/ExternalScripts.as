package com.pulsepoint.utils {	import flash.external.ExternalInterface;
	import com.pulsepoint.page.ElementNode;	public class ExternalScripts {		private var _scripts:Array;
		var _elementNode:ElementNode = ElementNode.getInstance();		public function ExternalScripts(scripts:Array):void {			_scripts = scripts;			if (ExternalInterface.available) {				try {					ExternalInterface.call("function(){" +					 	"window.ppa.loadScript = function(url, initFunc, uid, params) {" +							"var js = window.document.createElement('script');" +							"js.src = url;" +							"js.addEventListener('load', function() {" +								"var func;" +								"var videoObject;" +								"try{" +									"func = eval(initFunc);" +									"videoObject = ppa.videoPlayer[uid];" +								"}catch(e){return;};" +								"if (typeof func === 'function' && typeof videoObject === 'object'){" +									"window.ppa.extScripts['" + _elementNode.uid + "'].push(new func(videoObject, params));" +								"}" +							"});" +							"window.document.body.appendChild(js);" +						"};" +					"}");				} catch (e:Error) {				}			}		}		public function execute():void{			if (ExternalInterface.available) {				for (var i:int = 0; i < _scripts.length; i++){					ExternalInterface.call("window.ppa.loadScript", _scripts[i].url, _scripts[i].init_function, _elementNode.uid, _scripts[i].params);				}			}		}		public function cleanup():void{			if (ExternalInterface.available) {				ExternalInterface.call("function(){" +					"if (window.ppa.extScripts && window.ppa.extScripts['" + _elementNode.uid + "']){" +						"for (var i = 0; i < window.ppa.extScripts['" + _elementNode.uid + "'].length; i++){" +							"if (typeof window.ppa.extScripts['" + _elementNode.uid + "'][i].shutdown === 'function'){" +								"window.ppa.extScripts['" + _elementNode.uid + "'][i].shutdown();" +							"}" +						"}" +
					"}" +				"}");			}		}	}}